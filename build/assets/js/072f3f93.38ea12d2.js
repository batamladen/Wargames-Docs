"use strict";(globalThis.webpackChunkwargames_docs=globalThis.webpackChunkwargames_docs||[]).push([[5599],{5828:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Architecture/Backend/nginx","title":"nginx","description":"\ud83e\udde9 Nginx Configuration","source":"@site/docs/Architecture/Backend/nginx.md","sourceDirName":"Architecture/Backend","slug":"/Architecture/Backend/nginx","permalink":"/docs/Architecture/Backend/nginx","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Architecture/Backend/nginx.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"server","permalink":"/docs/Architecture/Backend/Flask Scripts/server"},"next":{"title":"Community","permalink":"/docs/category/community"}}');var t=n(4848),i=n(8453);const d={},a=void 0,o={},c=[{value:"\ud83e\udde9 Nginx Configuration",id:"-nginx-configuration",level:2},{value:"Full Nginx Code",id:"full-nginx-code",level:2},{value:"\u2699\ufe0f Main Responsibilities",id:"\ufe0f-main-responsibilities",level:2},{value:"1. SSL Termination",id:"1-ssl-termination",level:3},{value:"2. Security Headers",id:"2-security-headers",level:3},{value:"3. Reverse Proxy Routing",id:"3-reverse-proxy-routing",level:3},{value:"4. Proxy Headers",id:"4-proxy-headers",level:3},{value:"5. HTTPS Support",id:"5-https-support",level:3},{value:"Summary",id:"summary",level:2}];function l(e){const r={br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h2,{id:"-nginx-configuration",children:"\ud83e\udde9 Nginx Configuration"}),"\n",(0,t.jsxs)(r.p,{children:["The ",(0,t.jsx)(r.strong,{children:"Nginx"})," service acts as a ",(0,t.jsx)(r.strong,{children:"reverse proxy"})," in front of the Flask backend, handling HTTPS encryption, routing, and basic security headers.",(0,t.jsx)(r.br,{}),"\n","It ensures that all API traffic is securely forwarded to the correct internal Flask applications running on the VPS."]}),"\n",(0,t.jsx)(r.p,{children:"This configuration file defines how requests are handled and routed inside the server."}),"\n",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(r.h2,{id:"full-nginx-code",children:"Full Nginx Code"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"server {\r\n    listen 443 ssl http2;\r\n    server_name <Domain>;\r\n\r\n    # SSL certificates\r\n    ssl_certificate <SSL path>/fullchain.pem;\r\n    ssl_certificate_key <SSL path>/privkey.pem;\r\n\r\n    # Security headers\r\n    add_header X-Frame-Options SAMEORIGIN;\r\n    add_header X-Content-Type-Options nosniff;\r\n\r\n    # Authentication routes\r\n    location /api/auth/ {\r\n        proxy_pass http://127.0.0.1:5050;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n    }\r\n\r\n    # Flag-related routes\r\n    location /api/flags/ {\r\n        proxy_pass http://127.0.0.1:5050;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n    }\r\n\r\n    # Academy (learning) routes\r\n    location /api/academy {\r\n        proxy_pass http://127.0.0.1:5050;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;\r\n    }\r\n\r\n    # Main API (container management and game logic)\r\n    location /api {\r\n        proxy_pass http://127.0.0.1:5000;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;        \r\n    }\r\n\r\n    # Password and flag verification service\r\n    location /check-password {\r\n        proxy_pass http://127.0.0.1:8080/check-password;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;\r\n    }\r\n}\r\n\n"})}),"\n",(0,t.jsx)(r.h2,{id:"\ufe0f-main-responsibilities",children:"\u2699\ufe0f Main Responsibilities"}),"\n",(0,t.jsx)(r.h3,{id:"1-ssl-termination",children:"1. SSL Termination"}),"\n",(0,t.jsxs)(r.p,{children:["Nginx manages HTTPS traffic using certificates issued by ",(0,t.jsx)(r.strong,{children:"Let\u2019s Encrypt"}),":"]}),"\n",(0,t.jsx)(r.h3,{id:"2-security-headers",children:"2. Security Headers"}),"\n",(0,t.jsx)(r.p,{children:"Basic protection headers are applied globally:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"add_header X-Frame-Options SAMEORIGIN;\r\nadd_header X-Content-Type-Options nosniff;\r\nThese help prevent clickjacking and MIME-type sniffing attacks.\n"})}),"\n",(0,t.jsx)(r.h3,{id:"3-reverse-proxy-routing",children:"3. Reverse Proxy Routing"}),"\n",(0,t.jsx)(r.p,{children:"Each backend service runs on a specific port.\r\nNginx forwards incoming API requests to the appropriate Flask process:"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Path"}),(0,t.jsx)(r.th,{children:"Internal Port"}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"/api/auth/"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"5050"})}),(0,t.jsx)(r.td,{children:"Handles login, registration, and authentication routes."})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"/api/flags/"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"5050"})}),(0,t.jsx)(r.td,{children:"Manages flag submission and validation endpoints."})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"/api/academy"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"5050"})}),(0,t.jsx)(r.td,{children:"Reserved for learning-related routes and user stats."})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"/api"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"5000"})}),(0,t.jsxs)(r.td,{children:["Main game backend (",(0,t.jsx)(r.code,{children:"server.py"}),") for container spawning and challenge control."]})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"/check-password"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"8080"})}),(0,t.jsxs)(r.td,{children:["Dedicated Flask app for isolated password/flag verification (",(0,t.jsx)(r.code,{children:"check-password.py"}),")."]})]})]})]}),"\n",(0,t.jsx)(r.h3,{id:"4-proxy-headers",children:"4. Proxy Headers"}),"\n",(0,t.jsx)(r.p,{children:"Nginx passes important client information to Flask:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"proxy_set_header X-Real-IP $remote_addr;\r\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\nproxy_set_header X-Forwarded-Proto $scheme;\n"})}),"\n",(0,t.jsx)(r.p,{children:"This ensures proper IP logging, HTTPS awareness, and consistent request handling."}),"\n",(0,t.jsx)(r.h3,{id:"5-https-support",children:"5. HTTPS Support"}),"\n",(0,t.jsx)(r.p,{children:"Enabled for improved performance:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"listen 443 ssl http2;\n"})}),"\n",(0,t.jsx)(r.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(r.p,{children:"The Nginx layer is the entry point of the WGM backend.\r\nIt:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Handles all HTTPS requests"}),"\n",(0,t.jsx)(r.li,{children:"Routes them to the correct Flask app"}),"\n",(0,t.jsx)(r.li,{children:"Applies basic security headers"}),"\n",(0,t.jsx)(r.li,{children:"Logs real client IPs"}),"\n",(0,t.jsx)(r.li,{children:"Enables modular scaling between multiple Flask processes"}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>d,x:()=>a});var s=n(6540);const t={},i=s.createContext(t);function d(e){const r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);